FROM parth9365/pymssql-python3

WORKDIR /usr/src/app

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

# Define default env variables for the image
ENV KAFKA_BROKER_IP=kafka 
ENV KAFKA_BROKER_POR=9092
ENV KAFKA_MOULD_DATA_TOPIC=mould_data
ENV KAFKA_SENSOR_DATA_TOPIC=sensor_data
ENV SQL_SERVER_IP=sqlserver-input
ENV SQL_SERVER_PORT=1433
ENV SQL_SERVER_USER=sa
ENV SQL_SERVER_PASS=MUCSI_Deusto2022
ENV SQL_SERVER_MOULD_DB=DB-MOULDING
ENV SQL_SERVER_SENSOR_DB=DB-SENSORS
ENV AM_I_IN_A_DOCKER_CONTAINER=1

COPY requirements.txt .
RUN pip install --upgrade pip
RUN pip install -r requirements.txt

COPY ./src .

ENTRYPOINT [ "python", "-u", "main.py" ]